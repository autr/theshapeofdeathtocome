function riseTombstone(e){e.position.y=-e.tombHeight/2;var t=new TWEEN.Tween(e.position).to({y:e.tombHeight/2+.5},6e3).onUpdate(function(){}).onComplete(function(){}).easing(TWEEN.Easing.Quadratic.InOut).start()}function createTombStone(e,t){var n=new Promise(function(n,a){var r=randomTexture();r.then(function(a){var r=10,o=.5*r,i=a.materials[4].map.image?o/800*a.materials[5].map.image.height:r,s=.1*r,u=new THREE.BoxGeometry(o,i,s),d=new THREE.Mesh(u,a);d.tombHeight=i,d.position.y=-i/2,d.position.x=e,d.position.z=t,shadow&&(d.receiveShadow=!0),shadow&&(d.castShadow=!0),scene.add(d),n(d)},function(e){console.log("Fail",e)})});return n}function randomTexture(){shuffledIndex=shuffledIndex<shuffled.length-1?shuffledIndex+1:0;var e=websites[shuffled[shuffledIndex]],t=new Promise(function(t,n){for(;-1!==e.indexOf("%2F");){var a=e.indexOf("%2F");e=e.substr(0,a+1)+"25"+e.substr(a+1)}for(;-1!==e.indexOf("%40");){var a=e.indexOf("%40");e=e.substr(0,a+1)+"25"+e.substr(a+1)}texture=new THREE.TextureLoader(manager).load("graves/"+e,function(){texture.minFilter=THREE.LinearFilter,texture.originalUrl=e;try{dummyCtx.drawImage(texture.image,0,0,1,1);var n=dummyCtx.getImageData(0,0,1,1).data,a="rgb("+n[0]+","+n[1]+","+n[2]+")",r=new THREE.MeshPhongMaterial({color:a})}catch(o){var r=new THREE.MeshPhongMaterial({color:"rgb(255,255,255)"})}var i=new THREE.MeshBasicMaterial({map:texture,needsUpdate:!0}),s=[r,r,r,r,i,i],u=new THREE.MeshFaceMaterial(s);t(u)})});return t}function updateRandomTexture(e){riseTombstone(e);var t=new randomTexture;t.then(function(t){e.material=t,e.needsUpdate=!0},function(e){})}