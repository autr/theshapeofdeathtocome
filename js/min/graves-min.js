function Grave(){var e=this,t,i,o,r,n,s,a=!0;this.size=10,this.depth=.1*e.size,this.w=.5*e.size,this.h=e.size,this.image=null,this.rise=function(){console.log("Grave.rise"),e.h=e.image?e.w/800*e.image.height:e.size,e.model.geometry=new THREE.BoxGeometry(e.w,e.h,e.depth),e.model.position.y=-e.h/2;var t=new TWEEN.Tween(e.model.position).to({y:e.h/2+.5},6e3).onUpdate(function(){console.log()}).onComplete(function(){}).easing(TWEEN.Easing.Quadratic.InOut).start()},this.init=function(t,i){var o=new Promise(function(o,r){e.geometry=new THREE.BoxGeometry(e.w,e.h,e.depth),e.model=new THREE.Mesh(e.geometry),e.model.position.y=-e.h/2,e.model.position.x=t,e.model.position.z=i,e.model.receiveShadow=!0,e.model.castShadow=!0,scene.add(e.model),console.log("Grave.init"),e.texturise().then(function(t){e.image=t,e.rise(),o()})});return o},this.texturise=function(){console.log("Grave.texturise"),shuffledIndex=shuffledIndex<shuffled.length-1?shuffledIndex+1:0,e.url=websites[shuffled[shuffledIndex]];var t=new Promise(function(t,i){for(;-1!==e.url.indexOf("%2F");){var o=e.url.indexOf("%2F");e.url=e.url.substr(0,o+1)+"25"+e.url.substr(o+1)}for(;-1!==e.url.indexOf("%40");){var o=e.url.indexOf("%40");e.url=e.url.substr(0,o+1)+"25"+e.url.substr(o+1)}var r=new THREE.TextureLoader,n=r.load("graves/"+e.url,function(){n.minFilter=THREE.LinearFilter;try{dummyCtx.drawImage(n.image,0,0,1,1);var i=dummyCtx.getImageData(0,0,1,1).data,o="rgb("+i[0]+","+i[1]+","+i[2]+")",r=new THREE.MeshPhongMaterial({color:o})}catch(s){var r=new THREE.MeshPhongMaterial({color:"rgb(255,255,255)"})}var a=new THREE.MeshBasicMaterial({map:n,needsUpdate:!0}),l=[r,r,r,r,a,a],d=new THREE.MeshFaceMaterial(l);e.model.material=d,e.model.needsUpdate=!0,t(n.image)})});return t}}