function riseTombstone(e){e.position.y=-e.tombHeight/2;var t=new TWEEN.Tween(e.position).to({y:e.tombHeight/2+.5},6e3).onUpdate(function(){}).onComplete(function(){}).easing(TWEEN.Easing.Quadratic.InOut).start()}function createTombStone(e,t){var n=new Promise(function(n,i){var o=randomTexture();o.then(function(i){var o=10,a=.5*o,r=i.materials[4].map.image?a/800*i.materials[5].map.image.height:o,s=.1*o,m=new THREE.BoxGeometry(a,r,s),g=new THREE.Mesh(m,i);g.tombHeight=r,g.position.y=-r/2,g.position.x=e,g.position.z=t,shadow&&(g.receiveShadow=!0),shadow&&(g.castShadow=!0),scene.add(g),n(g)},function(e){console.log("Fail",e)})});return n}function randomTexture(e){var t=!1,n=this;shuffledIndex=shuffledIndex<shuffled.length-1?shuffledIndex+1:0,this.img=websites[shuffled[shuffledIndex]],t&&console.log("1st",n.img);var i=new Promise(function(e,i){for(;-1!==n.img.indexOf("%2F");){var o=n.img.indexOf("%2F");n.img=n.img.substr(0,o+1)+"25"+n.img.substr(o+1)}for(;-1!==n.img.indexOf("%40");){var o=n.img.indexOf("%40");n.img=n.img.substr(0,o+1)+"25"+n.img.substr(o+1)}t&&console.log("2nd",n.img),texture=new THREE.TextureLoader(manager).load("graves/"+n.img,function(){texture.minFilter=THREE.LinearFilter,texture.originalUrl=n.img,t&&console.log("3rd",n.img);try{dummyCtx.drawImage(texture.image,0,0,1,1);var i=dummyCtx.getImageData(0,0,1,1).data,o="rgb("+i[0]+","+i[1]+","+i[2]+")",a=new THREE.MeshPhongMaterial({color:o})}catch(r){var a=new THREE.MeshPhongMaterial({color:"rgb(255,255,255)"})}var s=new THREE.MeshBasicMaterial({map:texture,needsUpdate:!0}),m=[a,a,a,a,s,s],g=new THREE.MeshFaceMaterial(m);e(g)})});return i}function updateRandomTexture(e){riseTombstone(e);var t=new randomTexture;t.then(function(t){e.material=t,e.needsUpdate=!0},function(e){})}